var Qe=Object.defineProperty;var Ye=(o,t,s)=>t in o?Qe(o,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[t]=s;var G=(o,t,s)=>Ye(o,typeof t!="symbol"?t+"":t,s);import{j as e}from"./jsx-runtime-B-vjrZM9.js";import{u as de,b as Xe,L as et,I as tt,n as st}from"./nl-wD7mEgNa.js";import{r as S}from"./iframe-NSoKY1mh.js";import{l as le,u as ce,a as He,U as it}from"./storage-CudcsGZD.js";import{B as L}from"./Button-CIR6_DzN.js";import{B as C}from"./Badge-B_suzCdo.js";import{X as at,T as rt,C as ge}from"./Toast-D0GZ4Fb-.js";import{M as l}from"./message-B7qOD586.js";import{I as pe}from"./info-C2gruAa0.js";import{c as T}from"./createLucideIcon-BoUbEuam.js";import{T as M}from"./triangle-alert-DrSJen0x.js";import{U as _e}from"./users-lZfVf0nk.js";import{C as Re,T as nt}from"./trending-up-BbNKy0n9.js";import{C as xe}from"./clock-CREGzEKH.js";import{A as lt}from"./activity-KPUiyzkZ.js";import{C as W}from"./circle-check-big-D9i8mzBq.js";import{A as ot,R as fe,S as dt}from"./save-B676d_8f.js";import{F as ct,S as mt}from"./settings-DdbwuDnu.js";import"./preload-helper-C1FmrZbK.js";import"./cn-BNf5BS2b.js";/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=T("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=T("Diff",[["path",{d:"M12 3v14",key:"7cf3v8"}],["path",{d:"M5 10h14",key:"elsbfy"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=T("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=T("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=T("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=T("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=T("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=T("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),xt={delay:{editable:!0,riskLevel:"low",requiresApproval:!1},enabled:{editable:!0,riskLevel:"medium",requiresApproval:!0,reason:"Disabling steps can affect patient care continuity"},automated:{editable:!0,riskLevel:"low",requiresApproval:!1},action:{editable:!1,riskLevel:"high",requiresApproval:!0,reason:"Changing clinical actions requires medical oversight"},trigger:{editable:!1,riskLevel:"high",requiresApproval:!0,reason:"Modifying triggers can affect patient identification"},name:{editable:!0,riskLevel:"low",requiresApproval:!1}},ft={hba1c:{editable:!0,riskLevel:"high",requiresApproval:!0,reason:"HbA1c thresholds directly impact patient safety"},systolic:{editable:!0,riskLevel:"high",requiresApproval:!0,reason:"Blood pressure thresholds are critical for cardiovascular safety"},diastolic:{editable:!0,riskLevel:"high",requiresApproval:!0,reason:"Blood pressure thresholds are critical for cardiovascular safety"},bmi:{editable:!0,riskLevel:"medium",requiresApproval:!1}},vt=["annual_review","spirometry_baseline","bp_confirmation"],Pe=o=>vt.includes(o),yt=(o,t)=>{let s="low";return t.steps.forEach((a,i)=>{const n=o.steps[i];n&&(Object.keys(a).forEach(r=>{const c=xt[r];c&&c.riskLevel==="high"?s="high":c&&c.riskLevel==="medium"&&s!=="high"&&(s="medium")}),a.enabled===!1&&Pe(n.id)&&(s="high"))}),t.thresholds&&Object.keys(t.thresholds).forEach(a=>{const i=ft[a];i&&i.riskLevel==="high"?s="high":i&&i.riskLevel==="medium"&&s!=="high"&&(s="medium")}),s},wt=o=>o==="high",bt=o=>`${o}-override-${Date.now()}`,jt=(o,t,s)=>({id:bt(o.id),originalTemplateId:o.id,name:{nl:`${o.name.nl} (Lokale Aanpassing)`,en:`${o.name.en} (Local Override)`},description:{nl:`Lokale aanpassing van ${o.name.nl}`,en:`Local override of ${o.name.en}`},version:`${o.version}-local`,isNHGDefault:!1,isModified:!0,isLocalOverride:!0,lastModified:new Date().toISOString(),createdBy:t,justification:s,riskLevel:"low",pendingApproval:!1,overrides:{steps:o.steps.map(()=>({}))},originalTemplate:o}),z={getOverrides:()=>{const o=sessionStorage.getItem("pathwayOverrides");return o?JSON.parse(o):[]},saveOverride:o=>{const t=z.getOverrides(),s=t.findIndex(a=>a.id===o.id);s>=0?t[s]=o:t.push(o),sessionStorage.setItem("pathwayOverrides",JSON.stringify(t))},deleteOverride:o=>{const s=z.getOverrides().filter(a=>a.id!==o);sessionStorage.setItem("pathwayOverrides",JSON.stringify(s))},getOverrideByTemplateId:o=>z.getOverrides().find(s=>s.originalTemplateId===o)},Nt=[{id:"nhg-t2dm-v2024",name:{nl:"Type 2 Diabetes Mellitus Zorgpad",en:"Type 2 Diabetes Mellitus Care Pathway"},description:{nl:"NHG-standaard voor T2DM monitoring en interventie volgens de richtlijnen van 2024",en:"NHG standard for T2DM monitoring and intervention according to 2024 guidelines"},condition:"T2DM",version:"2024.1",isNHGDefault:!0,isModified:!1,lastModified:null,createdBy:"NHG",summary:{totalSteps:4,avgDuration:"6 months",priority:"high"},thresholds:{hba1c:70,systolic:140,diastolic:90,bmi:30},steps:[{id:"initial_screening",name:{nl:"Initiële Screening",en:"Initial Screening"},trigger:{nl:"HbA1c > 70 mmol/mol of nieuwe diagnose",en:"HbA1c > 70 mmol/mol or new diagnosis"},action:{nl:"Uitgebreid intake gesprek en baseline metingen",en:"Comprehensive intake and baseline measurements"},delay:0,enabled:!0,automated:!1},{id:"lifestyle_intervention",name:{nl:"Leefstijl Interventie",en:"Lifestyle Intervention"},trigger:{nl:"Na initiële screening",en:"After initial screening"},action:{nl:"Voeding- en bewegingsadvies, verwijzing diëtist indien nodig",en:"Nutrition and exercise advice, dietitian referral if needed"},delay:1,enabled:!0,automated:!0},{id:"follow_up_3m",name:{nl:"3-Maanden Controle",en:"3-Month Follow-up"},trigger:{nl:"3 maanden na start interventie",en:"3 months after intervention start"},action:{nl:"HbA1c controle, medicatie evaluatie",en:"HbA1c check, medication evaluation"},delay:90,enabled:!0,automated:!0},{id:"annual_review",name:{nl:"Jaarlijkse Evaluatie",en:"Annual Review"},trigger:{nl:"Jaarlijks terugkerende controle",en:"Annual recurring check"},action:{nl:"Volledige evaluatie: HbA1c, lipiden, nieren, ogen",en:"Complete evaluation: HbA1c, lipids, kidneys, eyes"},delay:365,enabled:!0,automated:!0}]},{id:"nhg-hypertension-v2024",name:{nl:"Hypertensie Zorgpad",en:"Hypertension Care Pathway"},description:{nl:"NHG-standaard voor hypertensie monitoring en behandeling volgens 2024 richtlijnen",en:"NHG standard for hypertension monitoring and treatment per 2024 guidelines"},condition:"Hypertension",version:"2024.1",isNHGDefault:!0,isModified:!1,lastModified:null,createdBy:"NHG",summary:{totalSteps:3,avgDuration:"3 months",priority:"high"},thresholds:{systolic:140,diastolic:90,pulse:100},steps:[{id:"bp_confirmation",name:{nl:"Bloeddruk Bevestiging",en:"Blood Pressure Confirmation"},trigger:{nl:"Verhoogde bloeddruk > 140/90 mmHg",en:"Elevated blood pressure > 140/90 mmHg"},action:{nl:"Thuismeting of 24-uurs meting voor bevestiging",en:"Home measurement or 24-hour monitoring for confirmation"},delay:0,enabled:!0,automated:!0},{id:"lifestyle_counseling",name:{nl:"Leefstijladvies",en:"Lifestyle Counseling"},trigger:{nl:"Na bevestiging hypertensie",en:"After hypertension confirmation"},action:{nl:"Zoutbeperking, gewichtsverlies, bewegingsadvies",en:"Salt restriction, weight loss, exercise advice"},delay:7,enabled:!0,automated:!0},{id:"monthly_monitoring",name:{nl:"Maandelijkse Monitoring",en:"Monthly Monitoring"},trigger:{nl:"Maandelijks tot streefwaarde bereikt",en:"Monthly until target achieved"},action:{nl:"Bloeddruk controle en medicatie aanpassing",en:"Blood pressure check and medication adjustment"},delay:30,enabled:!0,automated:!0}]},{id:"nhg-asthma-copd-v2024",name:{nl:"Astma/COPD Zorgpad",en:"Asthma/COPD Care Pathway"},description:{nl:"NHG-standaard voor astma en COPD monitoring en exacerbatie preventie",en:"NHG standard for asthma and COPD monitoring and exacerbation prevention"},condition:"Respiratory",version:"2024.1",isNHGDefault:!0,isModified:!1,lastModified:null,createdBy:"NHG",summary:{totalSteps:4,avgDuration:"12 months",priority:"medium"},thresholds:{fev1:80,peakFlow:350,symptomsPerWeek:2},steps:[{id:"spirometry_baseline",name:{nl:"Longfunctie Baseline",en:"Lung Function Baseline"},trigger:{nl:"Nieuwe diagnose of jaarlijkse controle",en:"New diagnosis or annual check"},action:{nl:"Spirometrie en reversibiliteitstest",en:"Spirometry and reversibility test"},delay:0,enabled:!0,automated:!1},{id:"inhaler_technique",name:{nl:"Inhalatietechniek Training",en:"Inhaler Technique Training"},trigger:{nl:"Na diagnose of bij suboptimale controle",en:"After diagnosis or suboptimal control"},action:{nl:"Demonstratie en training juiste inhalatietechniek",en:"Demonstration and training of proper inhaler technique"},delay:7,enabled:!0,automated:!0},{id:"quarterly_review",name:{nl:"Kwartaal Evaluatie",en:"Quarterly Review"},trigger:{nl:"Elke 3 maanden voor controle optimalisatie",en:"Every 3 months for control optimization"},action:{nl:"Symptoomcontrole, medicatie review, peak flow",en:"Symptom control, medication review, peak flow"},delay:90,enabled:!0,automated:!0},{id:"vaccination_reminder",name:{nl:"Vaccinatie Herinnering",en:"Vaccination Reminder"},trigger:{nl:"Jaarlijks in oktober voor griepvaccinatie",en:"Annually in October for flu vaccination"},action:{nl:"Uitnodiging voor griep- en pneumokokken vaccinatie",en:"Invitation for flu and pneumococcal vaccination"},delay:365,enabled:!0,automated:!0}]}],V={getAssignments:()=>{const o=sessionStorage.getItem("patientPathwayAssignments");return o?JSON.parse(o):[]},saveAssignment:o=>{const t=V.getAssignments(),s=t.findIndex(a=>a.id===o.id);s>=0?t[s]=o:t.push(o),sessionStorage.setItem("patientPathwayAssignments",JSON.stringify(t)),le("patient_pathway_updated",{assignmentId:o.id,patientId:o.patientId,templateId:o.templateId})},getAssignmentsByPatient:o=>V.getAssignments().filter(t=>t.patientId===o),getActiveAssignmentsByPatient:o=>V.getAssignmentsByPatient(o).filter(t=>t.status==="active"),deleteAssignment:o=>{const s=V.getAssignments().filter(a=>a.id!==o);sessionStorage.setItem("patientPathwayAssignments",JSON.stringify(s))}},kt=()=>[{id:"c1",name:"T2DM High Risk",currentSize:45,condition:"T2DM"},{id:"c2",name:"Hypertension Monitoring",currentSize:32,condition:"Hypertension"},{id:"c3",name:"Respiratory Follow-up",currentSize:28,condition:"Respiratory"}],St=(o,t)=>{const s=kt(),i=V.getAssignments().filter(v=>v.templateId===o.id),n={total:i.length,byRiskLevel:i.reduce((v,I)=>{const h="medium";return v[h]=(v[h]||0)+1,v},{}),byPathway:{[o.id]:i.length}},r=o.steps,c=t.overrides.steps||[];let d=0,g=0,f=0,p=0;r.forEach((v,I)=>{const h=c[I];h&&(h.delay!==void 0&&h.delay<v.delay?d++:h.delay!==void 0&&h.delay>v.delay&&g++,h.enabled===!1&&v.enabled&&p++,h.enabled===!0&&!v.enabled&&f++)});const w=Math.floor(n.total*.3),y=Math.floor(n.total*.8),x=Math.floor(n.total*1.5),b=Math.floor(w*.5+y*.25),k=[],$=[];let A="low";p>0&&(k.push("Steps being removed from pathway"),A="medium"),d>3&&(k.push("Multiple steps accelerated significantly"),$.push("Accelerated timeline may increase patient burden"),A="high"),n.total>50&&(k.push("Large number of patients affected"),A=A==="low"?"medium":A),t.riskLevel==="high"&&(A="critical",$.push("High-risk override requiring dual approval"));const P=s.filter(v=>v.condition===o.condition).map(v=>({cohortId:v.id,cohortName:v.name,currentSize:v.currentSize,newSize:v.currentSize+Math.floor(Math.random()*10-5),change:Math.floor(Math.random()*10-5)}));return{changeType:"pathway_override",changeName:`Local Override: ${o.name.en}`,changeDescription:`Modifying ${r.length} pathway steps with ${c.length} overrides`,affectedPatients:n,cohortImpact:{cohortSizeChanges:P},workloadImpact:{immediateActions:w,weeklyActions:y,monthlyActions:x,estimatedHours:b},dueDateChanges:{accelerated:d,delayed:g,newSteps:f,removedSteps:p},riskAssessment:{level:A,factors:k,warnings:$}}};class At{constructor(){G(this,"storageKey","changeHistory");G(this,"maxEntries",1e3)}getChangeHistory(t){const s=this.getAllEntries();return t?s.filter(a=>{if(t.userId&&a.userId!==t.userId||t.changeType&&a.changeType!==t.changeType||t.status&&a.status!==t.status)return!1;if(t.dateFrom){const i=new Date(a.timestamp),n=new Date(t.dateFrom);if(i<n)return!1}if(t.dateTo){const i=new Date(a.timestamp),n=new Date(t.dateTo);if(i>n)return!1}if(t.searchText){const i=t.searchText.toLowerCase();if(![a.changeName,a.changeDescription,a.justification,a.userName].join(" ").toLowerCase().includes(i))return!1}return!0}):s}logChange(t,s,a,i,n,r,c,d,g){const f={id:`change-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,timestamp:new Date().toISOString(),userId:t,userName:s,changeType:r.changeType,changeName:a,changeDescription:i,justification:n,impactData:r,beforeState:c,afterState:d,canUndo:!!g,undoData:g,status:"applied"};return this.addEntry(f),f}undoChange(t,s,a){const i=this.getAllEntries(),n=i.findIndex(c=>c.id===t);if(n===-1)throw new Error("Change entry not found");const r=i[n];if(!r.canUndo||r.status!=="applied")throw new Error("Change cannot be undone");if(!r.undoData)throw new Error("Undo data not available");try{return this.executeUndo(r.undoData),r.status="undone",r.undoneAt=new Date().toISOString(),r.undoneBy=s,r.undoneReason=a,i[n]=r,this.saveEntries(i),!0}catch(c){throw r.status="failed",i[n]=r,this.saveEntries(i),c}}getUndoableChanges(t){return this.getAllEntries().filter(s=>{if(s.status!=="applied"||!s.canUndo||t&&s.userId!==t)return!1;const a=new Date(s.timestamp);return(new Date().getTime()-a.getTime())/(1e3*60*60)<=24})}getChangeStatistics(t,s){const a=this.getChangeHistory({dateFrom:t,dateTo:s}),i=a.reduce((c,d)=>(c[d.changeType]=(c[d.changeType]||0)+1,c),{}),n=a.reduce((c,d)=>(c[d.userName]=(c[d.userName]||0)+1,c),{}),r=a.reduce((c,d)=>(c[d.status]=(c[d.status]||0)+1,c),{});return{total:a.length,byType:i,byUser:n,byStatus:r,totalPatientsAffected:a.reduce((c,d)=>c+d.impactData.affectedPatients.total,0),averageRiskLevel:this.calculateAverageRisk(a)}}getAllEntries(){const t=sessionStorage.getItem(this.storageKey);if(!t)return[];try{return JSON.parse(t)}catch(s){return console.error("Error parsing change history:",s),[]}}addEntry(t){const s=this.getAllEntries();s.unshift(t),s.length>this.maxEntries&&s.splice(this.maxEntries),this.saveEntries(s)}saveEntries(t){try{sessionStorage.setItem(this.storageKey,JSON.stringify(t))}catch(s){console.error("Error saving change history:",s)}}executeUndo(t){switch(console.log("Executing undo operation:",t),t.type){case"pathway_override":break;case"threshold_update":break;case"configuration_change":break;default:throw new Error("Unknown undo operation type")}}calculateAverageRisk(t){if(t.length===0)return"low";const s={low:1,medium:2,high:3,critical:4},i=t.reduce((n,r)=>n+(s[r.impactData.riskAssessment.level]||1),0)/t.length;return i>=3.5?"critical":i>=2.5?"high":i>=1.5?"medium":"low"}}const Ot=new At,Dt=(o,t,s,a,i,n,r)=>Ot.logChange(o,t,`Pathway Override: ${s}`,`Created local override for ${s}`,a,i,n,r,{type:"pathway_override",templateId:n.id,overrideId:r.id}),Lt={T2DM:["annual_review","hba1c_monitoring","complications_screening","medication_review"],Hypertension:["annual_review","bp_monitoring","cardiovascular_assessment","medication_review"],Respiratory:["annual_review","lung_function_test","inhaler_technique","exacerbation_plan"]},B={lab_results:["sms","portal"],appointment_reminder:["sms","email"],medication_change:["phone","portal"],urgent_follow_up:["phone","sms"],routine_follow_up:["email","portal"]},Ct=(o,t)=>{const s=[],a=[],i=[],n=[],r=(t==null?void 0:t.overrides.steps)||o.steps,c=Lt[o.condition]||[],d=r.map((p,w)=>{const y=t==null?void 0:t.overrides.steps[w];return((y==null?void 0:y.enabled)!==void 0?y.enabled:p.enabled)?p.id:null}).filter(Boolean);c.forEach(p=>{d.includes(p)||(i.push(p),s.push({field:"steps",stepId:p,severity:"error",message:{en:`Required step "${p}" is missing or disabled. This step is mandatory per NHG guidelines.`,nl:`Vereiste stap "${p}" ontbreekt of is uitgeschakeld. Deze stap is verplicht volgens NHG richtlijnen.`},nhgReference:`NHG-${o.condition}-${p}`}))}),r.forEach((p,w)=>{var P,v,I,h,D,O;const y=t==null?void 0:t.overrides.steps[w];if(!((y==null?void 0:y.enabled)!==void 0?y.enabled:p.enabled))return;const b=((v=(P=p.action)==null?void 0:P.en)==null?void 0:v.toLowerCase())||"";let k=[];b.includes("lab")||b.includes("result")?k=B.lab_results:b.includes("appointment")?k=B.appointment_reminder:b.includes("medication")?k=B.medication_change:b.includes("urgent")||(I=p.id)!=null&&I.includes("urgent")?k=B.urgent_follow_up:k=B.routine_follow_up;const $=p.notificationChannels||[],A=k.filter(H=>!$.includes(H));A.length>0&&(n.push(...A),s.push({field:"notificationChannels",stepId:p.id,severity:"error",message:{en:`Step "${((h=p.name)==null?void 0:h.en)||"unknown"}" is missing required notification channels: ${A.join(", ")}`,nl:`Stap "${((D=p.name)==null?void 0:D.nl)||((O=p.name)==null?void 0:O.en)||"onbekend"}" mist vereiste notificatiekanalen: ${A.join(", ")}`}}))}),r.some((p,w)=>{const y=t==null?void 0:t.overrides.steps[w],x=(y==null?void 0:y.delay)!==void 0?y.delay:p.delay;return((y==null?void 0:y.enabled)!==void 0?y.enabled:p.enabled)&&x===0})||s.push({field:"steps",severity:"error",message:{en:"Pathway must have at least one initial step (delay = 0)",nl:"Zorgpad moet minstens één initiële stap hebben (vertraging = 0)"}}),r.forEach((p,w)=>{var k,$,A,P;const y=t==null?void 0:t.overrides.steps[w];if(!y)return;const x=p.delay,b=y.delay;b!==void 0&&x!==void 0&&(p.id&&c.includes(p.id)&&b>x*2&&a.push({field:"delay",stepId:p.id,severity:"warning",message:{en:`Delay for critical step "${((k=p.name)==null?void 0:k.en)||"unknown"}" increased significantly (${x} → ${b} days). Consider clinical impact.`,nl:`Vertraging voor kritieke stap "${(($=p.name)==null?void 0:$.nl)||((A=p.name)==null?void 0:A.en)||"onbekend"}" significant toegenomen (${x} → ${b} dagen). Overweeg klinische impact.`},nhgReference:`NHG-timing-${p.id}`}),(P=p.id)!=null&&P.includes("annual")&&b<350&&s.push({field:"delay",stepId:p.id,severity:"error",message:{en:"Annual review cannot be scheduled more frequently than yearly (minimum 350 days)",nl:"Jaarlijkse controle kan niet vaker dan jaarlijks worden gepland (minimum 350 dagen)"},nhgReference:"NHG-annual-frequency"}))}),o.thresholds&&Object.entries(o.thresholds).forEach(([p,w])=>{p.includes("hba1c")&&typeof w=="number"&&(w>75&&a.push({field:"thresholds",severity:"warning",message:{en:`HbA1c threshold ${w} mmol/mol is above NHG recommended maximum (75 mmol/mol)`,nl:`HbA1c drempelwaarde ${w} mmol/mol ligt boven NHG aanbevolen maximum (75 mmol/mol)`},nhgReference:"NHG-M01-HbA1c"}),w<42&&s.push({field:"thresholds",severity:"error",message:{en:`HbA1c threshold ${w} mmol/mol is dangerously low (minimum safe threshold: 42 mmol/mol)`,nl:`HbA1c drempelwaarde ${w} mmol/mol is gevaarlijk laag (minimum veilige drempel: 42 mmol/mol)`},nhgReference:"NHG-M01-HbA1c-safety"})),p.includes("bp_systolic")&&typeof w=="number"&&(w<110&&s.push({field:"thresholds",severity:"error",message:{en:`Systolic BP threshold ${w} mmHg is too low (minimum safe threshold: 110 mmHg)`,nl:`Systolische BD drempel ${w} mmHg is te laag (minimum veilige drempel: 110 mmHg)`},nhgReference:"NHG-M84-BP-safety"}),w>180&&a.push({field:"thresholds",severity:"warning",message:{en:`Systolic BP threshold ${w} mmHg is above NHG target range`,nl:`Systolische BD drempel ${w} mmHg ligt boven NHG streefgebied`},nhgReference:"NHG-M84-BP-target"}))});const f=s.length>0;return{isValid:!f,errors:s,warnings:a,canSaveDraft:!0,canRequestReview:!f,canPublish:!f&&i.length===0&&n.length===0,missingRequiredSteps:i,missingNotificationChannels:n}};class $t{constructor(){G(this,"storageKey","pathwayWorkflows")}getWorkflowMetadata(t){return this.getAllWorkflows()[t]||null}initializeWorkflow(t,s,a,i="draft"){const n=this.getAllWorkflows(),r={currentState:i,version:1,transitions:[{id:`${t}-${Date.now()}`,timestamp:new Date().toISOString(),fromState:"draft",toState:i,userId:s,userName:a,comment:"Workflow initialized"}],lastModified:new Date().toISOString(),modifiedBy:a};return n[t]=r,this.saveWorkflows(n),r}transitionState(t,s,a,i,n,r,c){const d=this.getAllWorkflows(),g=d[t];if(!g)throw new Error("Workflow not found");if(!this.isValidTransition(g.currentState,s))throw new Error(`Invalid transition from ${g.currentState} to ${s}`);const f={id:`${t}-${Date.now()}`,timestamp:new Date().toISOString(),fromState:g.currentState,toState:s,userId:a,userName:i,comment:n,reviewNotes:r,approvedBy:c,approvedAt:c?new Date().toISOString():void 0};return g.currentState=s,g.version++,g.transitions.push(f),g.lastModified=new Date().toISOString(),g.modifiedBy=i,s==="published"&&(g.publishedBy=i,g.publishedAt=new Date().toISOString()),d[t]=g,this.saveWorkflows(d),g}getWorkflowCapabilities(t,s,a,i){const n=(i==null?void 0:i.modifiedBy)===a,r=s==="gp"||s==="practice-manager",c=s==="poh-s"||s==="practice-manager";return{canEdit:t==="draft"&&c||t==="review",canSaveDraft:c,canRequestReview:t==="draft"&&n,canApproveReview:t==="review"&&r&&!n,canRejectReview:t==="review"&&r&&!n,canPublish:t==="review"&&r,canArchive:t==="published"&&r,canSchedulePublish:t==="review"&&r}}isValidTransition(t,s){var i;return((i={draft:["review","archived"],review:["draft","published","archived"],published:["archived"],archived:["draft"]}[t])==null?void 0:i.includes(s))??!1}getOverridesByState(t){const s=this.getAllWorkflows();return Object.keys(s).filter(a=>s[a].currentState===t)}getPendingReviews(){const t=this.getAllWorkflows();return Object.entries(t).filter(([s,a])=>a.currentState==="review").map(([s,a])=>({overrideId:s,workflow:a}))}getRecentlyPublished(t=7){const s=this.getAllWorkflows(),a=new Date(Date.now()-t*24*60*60*1e3);return Object.entries(s).filter(([i,n])=>n.currentState!=="published"||!n.publishedAt?!1:new Date(n.publishedAt)>a).map(([i,n])=>({overrideId:i,workflow:n})).sort((i,n)=>new Date(n.workflow.publishedAt).getTime()-new Date(i.workflow.publishedAt).getTime())}getWorkflowStatistics(){const t=this.getAllWorkflows(),s=Object.values(t).reduce((a,i)=>(a[i.currentState]=(a[i.currentState]||0)+1,a),{});return{draft:s.draft||0,review:s.review||0,published:s.published||0,archived:s.archived||0,total:Object.values(s).reduce((a,i)=>a+i,0)}}schedulePublication(t,s,a,i){const n=this.getAllWorkflows(),r=n[t];if(!r||r.currentState!=="review")throw new Error("Can only schedule publication for overrides in review state");return r.scheduledPublishAt=s.toISOString(),r.lastModified=new Date().toISOString(),r.modifiedBy=i,n[t]=r,this.saveWorkflows(n),r}processScheduledPublications(){const t=this.getAllWorkflows(),s=new Date,a=[];return Object.entries(t).forEach(([i,n])=>{if(n.currentState==="review"&&n.scheduledPublishAt&&new Date(n.scheduledPublishAt)<=s)try{const r=this.transitionState(i,"published","system","Automated Publication","Scheduled publication executed");a.push({overrideId:i,workflow:r})}catch(r){console.error(`Failed to publish scheduled override ${i}:`,r)}}),a}getAllWorkflows(){const t=sessionStorage.getItem(this.storageKey);if(!t)return{};try{return JSON.parse(t)}catch(s){return console.error("Error parsing workflows:",s),{}}}saveWorkflows(t){try{sessionStorage.setItem(this.storageKey,JSON.stringify(t))}catch(s){console.error("Error saving workflows:",s)}}}const K=new $t;class Ht{constructor(){G(this,"storageKey","practiceNotifications");G(this,"maxNotifications",200)}notifyPathwayPublished(t,s,a){const i={id:`pub-${t.id}-${Date.now()}`,type:"pathway_published",title:{en:"Pathway Updated",nl:"Zorgpad Bijgewerkt"},message:{en:`Local override for "${s.name.en}" has been published and is now active.`,nl:`Lokale overschrijving voor "${s.name.nl||s.name.en}" is gepubliceerd en nu actief.`},createdAt:new Date().toISOString(),actionRequired:!0,priority:"high",data:{overrideId:t.id,templateId:s.id,templateName:s.name.en,publishedBy:a.publishedBy,actionUrl:`/config/templates/${s.id}/override/${t.id}`},expiresAt:new Date(Date.now()+2592e6).toISOString()};return this.addNotification(i)}notifyReviewRequested(t,s,a){const i={id:`rev-${t.id}-${Date.now()}`,type:"pathway_review_requested",title:{en:"Review Requested",nl:"Beoordeling Aangevraagd"},message:{en:`${a} has requested review for pathway override "${s.name.en}".`,nl:`${a} heeft beoordeling aangevraagd voor zorgpad overschrijving "${s.name.nl||s.name.en}".`},userRole:"gp",createdAt:new Date().toISOString(),actionRequired:!0,priority:"medium",data:{overrideId:t.id,templateId:s.id,templateName:s.name.en,actionUrl:`/config/templates/${s.id}/override/${t.id}/review`}};return this.addNotification(i)}notifyNHGDeviations(t,s,a){const i=a.filter(c=>c.riskLevel==="high"||c.riskLevel==="critical"),n=i.length>0?"urgent":"high",r={id:`dev-${t.id}-${Date.now()}`,type:"nhg_deviation_alert",title:{en:"NHG Deviation Alert",nl:"NHG Afwijking Waarschuwing"},message:{en:`Pathway "${s.name.en}" contains ${a.length} deviation(s) from NHG guidelines. ${i.length>0?"High-risk deviations detected.":""}`,nl:`Zorgpad "${s.name.nl||s.name.en}" bevat ${a.length} afwijking(en) van NHG richtlijnen. ${i.length>0?"Hoog-risico afwijkingen gedetecteerd.":""}`},createdAt:new Date().toISOString(),actionRequired:!0,priority:n,data:{overrideId:t.id,templateId:s.id,templateName:s.name.en,deviations:a,actionUrl:`/config/templates/${s.id}/override/${t.id}/deviations`},expiresAt:new Date(Date.now()+90*24*60*60*1e3).toISOString()};return this.addNotification(r)}getUserNotifications(t,s,a=!1){const i=this.getAllNotifications(),n=new Date;return i.filter(r=>!(r.expiresAt&&new Date(r.expiresAt)<n||r.userId&&r.userId!==t||r.userRole&&r.userRole!==s||a&&r.readAt)).sort((r,c)=>new Date(c.createdAt).getTime()-new Date(r.createdAt).getTime())}markAsRead(t,s){const a=this.getAllNotifications(),i=a.find(n=>n.id===t);i&&!i.readAt&&(i.readAt=new Date().toISOString(),this.saveNotifications(a))}markAllAsRead(t,s){const a=this.getAllNotifications();let i=!1;a.forEach(n=>{(!n.userId||n.userId===t)&&(!n.userRole||n.userRole===s)&&!n.readAt&&(n.readAt=new Date().toISOString(),i=!0)}),i&&this.saveNotifications(a)}getNotificationStats(t,s){const a=this.getUserNotifications(t,s),i=this.getUserNotifications(t,s,!0),n=a.reduce((d,g)=>(d[g.type]=(d[g.type]||0)+1,d),{}),r=a.reduce((d,g)=>(d[g.priority]=(d[g.priority]||0)+1,d),{}),c=a.filter(d=>d.actionRequired&&!d.readAt).length;return{total:a.length,unread:i.length,actionRequired:c,byType:n,byPriority:r}}cleanupExpired(){const t=this.getAllNotifications(),s=new Date,a=t.filter(i=>!i.expiresAt||new Date(i.expiresAt)>=s);a.length!==t.length&&this.saveNotifications(a)}getPracticeNotifications(){return this.getAllNotifications().filter(t=>!t.userId).sort((t,s)=>new Date(s.createdAt).getTime()-new Date(t.createdAt).getTime())}createSystemNotification(t,s,a="medium",i=!1,n=30){const r={id:`sys-${Date.now()}`,type:"system_update",title:t,message:s,createdAt:new Date().toISOString(),actionRequired:i,priority:a,data:{},expiresAt:new Date(Date.now()+n*24*60*60*1e3).toISOString()};return this.addNotification(r)}addNotification(t){const s=this.getAllNotifications();return s.unshift(t),s.length>this.maxNotifications&&s.splice(this.maxNotifications),this.saveNotifications(s),t}getAllNotifications(){const t=sessionStorage.getItem(this.storageKey);if(!t)return[];try{return JSON.parse(t)}catch(s){return console.error("Error parsing notifications:",s),[]}}saveNotifications(t){try{sessionStorage.setItem(this.storageKey,JSON.stringify(t))}catch(s){console.error("Error saving notifications:",s)}}}const ne=new Ht,_t={T2DM:{thresholds:{hba1c_target:{value:53,range:[42,75],unit:"mmol/mol",critical:!0},hba1c_high_risk:{value:75,range:[70,85],unit:"mmol/mol",critical:!0},bp_systolic_target:{value:140,range:[130,150],unit:"mmHg",critical:!1},bp_diastolic_target:{value:85,range:[80,90],unit:"mmHg",critical:!1}},intervals:{hba1c_monitoring:{value:90,range:[60,180],unit:"days",critical:!1},annual_review:{value:365,range:[350,380],unit:"days",critical:!0},bp_monitoring:{value:90,range:[60,120],unit:"days",critical:!1},complications_screening:{value:365,range:[350,380],unit:"days",critical:!0}},requiredSteps:["annual_review","hba1c_monitoring","complications_screening","medication_review"]},Hypertension:{thresholds:{bp_systolic_target:{value:140,range:[130,150],unit:"mmHg",critical:!0},bp_diastolic_target:{value:90,range:[85,95],unit:"mmHg",critical:!0},cardiovascular_risk:{value:10,range:[7.5,15],unit:"%",critical:!1}},intervals:{bp_monitoring:{value:90,range:[60,120],unit:"days",critical:!1},annual_review:{value:365,range:[350,380],unit:"days",critical:!0},cardiovascular_assessment:{value:365,range:[350,380],unit:"days",critical:!0}},requiredSteps:["annual_review","bp_monitoring","cardiovascular_assessment","medication_review"]},Respiratory:{thresholds:{pef_variability:{value:20,range:[15,25],unit:"%",critical:!1},exacerbation_threshold:{value:2,range:[2,3],unit:"per year",critical:!0}},intervals:{lung_function_test:{value:365,range:[350,380],unit:"days",critical:!0},annual_review:{value:365,range:[350,380],unit:"days",critical:!0},inhaler_technique:{value:180,range:[120,240],unit:"days",critical:!1}},requiredSteps:["annual_review","lung_function_test","inhaler_technique","exacerbation_plan"]}};class Rt{analyzeDeviations(t,s){const a=[],i=t.condition,n=_t[i];return n?(s.overrides.thresholds&&Object.entries(s.overrides.thresholds).forEach(([r,c])=>{const d=n.thresholds[r];if(d&&typeof d=="object"&&"value"in d){const g=d;if(c!==g.value){const f=this.createThresholdDeviation(r,g,c,t.condition);f&&a.push(f)}}}),s.overrides.steps&&s.overrides.steps.forEach((r,c)=>{const d=t.steps[c];if(!(!d||!r)){if(r.delay!==void 0&&r.delay!==d.delay){const g=n.intervals[d.id];if(g){const f=this.createTimingDeviation(d,g,r.delay,t.condition);f&&a.push(f)}}if(r.enabled===!1&&d.enabled&&n.requiredSteps.includes(d.id)){const g=this.createStepRemovalDeviation(d,t.condition);a.push(g)}if(r.action&&typeof r.action=="string"&&d.action&&typeof d.action=="object"&&r.action!==d.action.en){const g=this.createStepModificationDeviation(d,d.action.en||"",r.action,t.condition);a.push(g)}}}),a.sort((r,c)=>{const d={critical:4,high:3,medium:2,low:1};return d[c.riskLevel]-d[r.riskLevel]})):(console.warn(`No NHG standards defined for condition: ${i}`),a)}getDeviationSummary(t){const s=t.reduce((r,c)=>(r[c.riskLevel]=(r[c.riskLevel]||0)+1,r),{}),a=t.reduce((r,c)=>(r[c.deviationType]=(r[c.deviationType]||0)+1,r),{}),i=t.filter(r=>r.riskLevel==="critical").length,n=t.filter(r=>r.riskLevel==="high").length;return{total:t.length,byRisk:s,byType:a,criticalCount:i,highCount:n,requiresReview:i>0||n>2,overallRisk:i>0?"critical":n>0?"high":t.length>0?"medium":"low"}}isAcceptableDeviation(t,s){return t.riskLevel==="critical"?!1:t.riskLevel==="high"?!!(s&&s.length>100):!0}generateComplianceReport(t,s,a){const i=this.getDeviationSummary(a);return{templateName:t.name.en,condition:t.condition,analysisDate:new Date().toISOString(),nhgCompliance:{score:this.calculateComplianceScore(a),level:this.getComplianceLevel(a),deviationCount:a.length},deviations:a,summary:i,recommendations:this.generateRecommendations(a),actionRequired:i.criticalCount>0||i.highCount>2}}createThresholdDeviation(t,s,a,i){const n=a<s.range[0]||a>s.range[1],r=s.critical;let c="low";return n&&r?c="critical":n?c="high":a!==s.value&&(c="medium"),{id:`threshold-${t}-${Date.now()}`,field:t,deviationType:"threshold",nhgValue:`${s.value} ${s.unit}`,localValue:`${a} ${s.unit}`,riskLevel:c,impact:{patientSafety:r&&n?"critical":"moderate",clinicalOutcome:r?"significant":"moderate",compliance:n?"major":"moderate"},nhgReference:`NHG-${i}-${t}`,rationale:{en:`NHG guideline recommends ${s.value} ${s.unit} (acceptable range: ${s.range[0]}-${s.range[1]} ${s.unit})`,nl:`NHG richtlijn adviseert ${s.value} ${s.unit} (acceptabel bereik: ${s.range[0]}-${s.range[1]} ${s.unit})`},recommendation:{en:n?`Consider adjusting to within NHG recommended range (${s.range[0]}-${s.range[1]} ${s.unit})`:"Value differs from NHG standard but within acceptable range",nl:n?`Overweeg aanpassing naar NHG aanbevolen bereik (${s.range[0]}-${s.range[1]} ${s.unit})`:"Waarde wijkt af van NHG standaard maar binnen acceptabel bereik"}}}createTimingDeviation(t,s,a,i){const n=a<s.range[0]||a>s.range[1],r=s.critical;let c="low";return n&&r?c="critical":n?c="high":a!==s.value&&(c="medium"),{id:`timing-${t.id}-${Date.now()}`,field:"delay",stepId:t.id,stepName:t.name.en,deviationType:"timing",nhgValue:`${s.value} ${s.unit}`,localValue:`${a} ${s.unit}`,riskLevel:c,impact:{patientSafety:r&&n?"critical":"moderate",clinicalOutcome:r?"significant":"moderate",compliance:n?"major":"minor"},nhgReference:`NHG-${i}-timing-${t.id}`,rationale:{en:`NHG guideline recommends ${s.value} ${s.unit} interval for ${t.name.en}`,nl:`NHG richtlijn adviseert ${s.value} ${s.unit} interval voor ${t.name.nl||t.name.en}`},recommendation:{en:n?`Consider adjusting interval to ${s.range[0]}-${s.range[1]} ${s.unit}`:"Timing differs from standard but within acceptable range",nl:n?`Overweeg interval aanpassing naar ${s.range[0]}-${s.range[1]} ${s.unit}`:"Timing wijkt af van standaard maar binnen acceptabel bereik"}}}createStepRemovalDeviation(t,s){return{id:`removal-${t.id}-${Date.now()}`,field:"enabled",stepId:t.id,stepName:t.name.en,deviationType:"step_removal",nhgValue:"Required",localValue:"Disabled",riskLevel:"critical",impact:{patientSafety:"critical",clinicalOutcome:"critical",compliance:"severe"},nhgReference:`NHG-${s}-required-${t.id}`,rationale:{en:"This step is mandatory according to NHG guidelines and cannot be removed without clinical justification",nl:"Deze stap is verplicht volgens NHG richtlijnen en kan niet worden weggenomen zonder klinische onderbouwing"},recommendation:{en:"Re-enable this step or provide strong clinical justification for removal",nl:"Schakel deze stap weer in of geef sterke klinische onderbouwing voor weglaten"}}}createStepModificationDeviation(t,s,a,i){return{id:`modification-${t.id}-${Date.now()}`,field:"action",stepId:t.id,stepName:t.name.en,deviationType:"step_modification",nhgValue:s,localValue:a,riskLevel:"medium",impact:{patientSafety:"moderate",clinicalOutcome:"moderate",compliance:"moderate"},nhgReference:`NHG-${i}-action-${t.id}`,rationale:{en:"Step action has been modified from NHG standard",nl:"Stap actie is gewijzigd ten opzichte van NHG standaard"},recommendation:{en:"Review modification against clinical evidence and local protocols",nl:"Beoordeel wijziging tegen klinisch bewijs en lokale protocollen"}}}calculateComplianceScore(t){if(t.length===0)return 100;const s={critical:25,high:15,medium:5,low:2},a=t.reduce((i,n)=>i+s[n.riskLevel],0);return Math.max(0,100-a)}getComplianceLevel(t){const s=this.calculateComplianceScore(t);return s>=90?"excellent":s>=80?"good":s>=70?"acceptable":s>=60?"poor":"critical"}generateRecommendations(t){const s=[],a=t.filter(r=>r.riskLevel==="critical");a.length>0&&s.push({priority:"urgent",action:`Address ${a.length} critical deviation(s) immediately`});const i=t.filter(r=>r.riskLevel==="high");return i.length>2&&s.push({priority:"high",action:`Review ${i.length} high-risk deviations with clinical team`}),t.filter(r=>r.deviationType==="threshold").length>0&&s.push({priority:"medium",action:"Validate clinical thresholds against latest NHG guidelines"}),s}}const Pt=new Rt,Mt={hba1c_target:{rationale:{en:"HbA1c target of ≤53 mmol/mol (7%) for most adults with T2DM, based on NHG M01 guideline",nl:"HbA1c streefwaarde van ≤53 mmol/mol (7%) voor de meeste volwassenen met T2DM, gebaseerd op NHG M01 richtlijn"},clinicalLogic:{en:"Lower targets reduce microvascular complications. Higher targets (58 mmol/mol) may be appropriate for patients with limited life expectancy or high hypoglycemia risk.",nl:"Lagere streefwaarden verminderen microvasculaire complicaties. Hogere streefwaarden (58 mmol/mol) kunnen geschikt zijn voor patiënten met beperkte levensverwachting of hoog hypoglykemierisico."},riskLevel:"high",isRequired:!0},bp_target_systolic:{rationale:{en:"Systolic BP target <140 mmHg for most patients with hypertension, per NHG M84 guideline",nl:"Systolische BD streefwaarde <140 mmHg voor de meeste patiënten met hypertensie, volgens NHG M84 richtlijn"},clinicalLogic:{en:"Reduces cardiovascular events. Target <130 mmHg for high CVD risk patients. Avoid <120 mmHg due to increased adverse events.",nl:"Vermindert cardiovasculaire events. Streefwaarde <130 mmHg voor patiënten met hoog CVD-risico. Vermijd <120 mmHg vanwege toename van bijwerkingen."},riskLevel:"high",isRequired:!0},visit_interval:{rationale:{en:"Regular follow-up intervals ensure timely detection of complications and medication adjustments",nl:"Regelmatige controle-intervallen zorgen voor tijdige detectie van complicaties en medicatieaanpassingen"},clinicalLogic:{en:"T2DM patients: every 3 months if poor control, every 6 months if stable. Hypertension: every 3-6 months initially, then annually if controlled.",nl:"T2DM patiënten: elke 3 maanden bij slechte regulatie, elke 6 maanden bij stabiele situatie. Hypertensie: elke 3-6 maanden initieel, dan jaarlijks bij goede regulatie."},riskLevel:"medium",isRequired:!0},annual_review:{rationale:{en:"Annual comprehensive review is mandatory for chronic disease management per NHG guidelines",nl:"Jaarlijkse uitgebreide controle is verplicht voor chronische ziektemanagement volgens NHG richtlijnen"},clinicalLogic:{en:"Includes complications screening, medication review, lifestyle assessment, and care plan updates. Cannot be deferred without clinical justification.",nl:"Omvat complicatiescreening, medicatiereview, leefstijlbeoordeling en zorgplanupdate. Kan niet worden uitgesteld zonder klinische onderbouwing."},riskLevel:"critical",isRequired:!0},lab_frequency:{rationale:{en:"Laboratory monitoring frequency based on disease stability and medication adjustments",nl:"Laboratoriumcontrole frequentie gebaseerd op ziektstabiliteit en medicatieaanpassingen"},clinicalLogic:{en:"HbA1c every 3-6 months, lipids annually, kidney function every 6-12 months or as clinically indicated.",nl:"HbA1c elke 3-6 maanden, lipiden jaarlijks, nierfunctie elke 6-12 maanden of zoals klinisch geïndiceerd."},riskLevel:"medium",isRequired:!0},notification_channel:{rationale:{en:"Patient communication channels must be specified to ensure proper follow-up and safety notifications",nl:"Patiëntcommunicatiekanalen moeten worden gespecificeerd om goede follow-up en veiligheidsmeldingen te waarborgen"},clinicalLogic:{en:"At least one primary communication method required. SMS for urgent results, email for routine follow-up, phone for complex discussions.",nl:"Minstens één primaire communicatiemethode vereist. SMS voor urgente uitslagen, e-mail voor routine follow-up, telefoon voor complexe gesprekken."},riskLevel:"high",isRequired:!0}};function ee({field:o,nhgRationale:t,clinicalLogic:s,riskLevel:a,isRequired:i,children:n,className:r=""}){const{locale:c}=de(),[d,g]=S.useState(!1),f=Mt[o],p=t||(f==null?void 0:f.rationale[c])||"",w=s||(f==null?void 0:f.clinicalLogic[c])||"",y=a||(f==null?void 0:f.riskLevel)||"low",x=i!==void 0?i:(f==null?void 0:f.isRequired)||!1,b=()=>{switch(y){case"critical":return e.jsx(M,{className:"w-4 h-4 text-red-600"});case"high":return e.jsx(M,{className:"w-4 h-4 text-orange-600"});case"medium":return e.jsx(oe,{className:"w-4 h-4 text-yellow-600"});case"low":return e.jsx(pe,{className:"w-4 h-4 text-blue-600"});default:return e.jsx(pe,{className:"w-4 h-4 text-gray-600"})}},k=()=>{switch(y){case"critical":return"border-red-200 bg-red-50";case"high":return"border-orange-200 bg-orange-50";case"medium":return"border-yellow-200 bg-yellow-50";case"low":return"border-blue-200 bg-blue-50";default:return"border-gray-200 bg-gray-50"}};return!p&&!w?e.jsx("div",{className:r,children:n}):e.jsxs("div",{className:`relative ${r}`,children:[e.jsxs("div",{className:"flex items-center",onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),children:[n,e.jsxs("div",{className:"ml-2 flex items-center space-x-1",children:[b(),x&&e.jsx("span",{className:"text-red-500 text-sm font-bold",children:"*"})]})]}),d&&e.jsxs("div",{className:`absolute z-50 w-96 p-4 rounded-lg shadow-lg border ${k()} transform -translate-x-1/2 left-1/2 top-full mt-2`,children:[e.jsx("div",{className:`absolute -top-2 left-1/2 transform -translate-x-1/2 w-4 h-4 rotate-45 border-l border-t ${k()}`}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[b(),e.jsx("span",{className:"font-medium text-gray-900",children:e.jsx(l,{id:"clinicalTooltip.nhgGuidance"})}),x&&e.jsx("span",{className:"text-xs bg-red-100 text-red-800 px-2 py-1 rounded",children:e.jsx(l,{id:"clinicalTooltip.required"})})]}),p&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-800 mb-1",children:e.jsx(l,{id:"clinicalTooltip.rationale"})}),e.jsx("p",{className:"text-sm text-gray-700",children:p})]}),w&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-800 mb-1",children:e.jsx(l,{id:"clinicalTooltip.clinicalLogic"})}),e.jsx("p",{className:"text-sm text-gray-700",children:w})]}),e.jsx("div",{className:"pt-2 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-600",children:[e.jsx(l,{id:"clinicalTooltip.riskLevel"}),":"]}),e.jsx("span",{className:`font-medium ${y==="critical"?"text-red-600":y==="high"?"text-orange-600":y==="medium"?"text-yellow-600":"text-blue-600"}`,children:e.jsx(l,{id:`clinicalTooltip.risk.${y}`})})]})})]})]})]})}ee.__docgenInfo={description:"",methods:[],displayName:"ClinicalTooltip",props:{field:{required:!0,tsType:{name:"string"},description:""},nhgRationale:{required:!1,tsType:{name:"string"},description:""},clinicalLogic:{required:!1,tsType:{name:"string"},description:""},riskLevel:{required:!1,tsType:{name:"union",raw:"'low' | 'medium' | 'high' | 'critical'",elements:[{name:"literal",value:"'low'"},{name:"literal",value:"'medium'"},{name:"literal",value:"'high'"},{name:"literal",value:"'critical'"}]},description:""},isRequired:{required:!1,tsType:{name:"boolean"},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},className:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"''",computed:!1}}}};function Me({isOpen:o,impactData:t,onConfirm:s,onCancel:a}){const{user:i}=ce(),[n,r]=S.useState(""),[c,d]=S.useState(!1),[g,f]=S.useState(!1);if(!o)return null;const p=x=>{switch(x){case"critical":return"text-red-600 bg-red-50 border-red-200";case"high":return"text-orange-600 bg-orange-50 border-orange-200";case"medium":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"low":return"text-green-600 bg-green-50 border-green-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},w=x=>{switch(x){case"critical":return e.jsx(M,{className:"w-5 h-5"});case"high":return e.jsx(M,{className:"w-5 h-5"});case"medium":return e.jsx(xe,{className:"w-5 h-5"});case"low":return e.jsx(W,{className:"w-5 h-5"});default:return e.jsx(lt,{className:"w-5 h-5"})}},y=async()=>{if(n.trim()){d(!0);try{await s(n)}catch(x){console.error("Error applying changes:",x)}finally{d(!1)}}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto mx-4",children:[e.jsx("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:e.jsx(l,{id:"impactPreview.title"})}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.changeName})]}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(at,{className:"w-5 h-5 text-gray-500"})})]})}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:`border rounded-lg p-4 ${p(t.riskAssessment.level)}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[w(t.riskAssessment.level),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium mb-2",children:e.jsx(l,{id:`impactPreview.riskLevel.${t.riskAssessment.level}`})}),e.jsx("p",{className:"text-sm mb-3",children:t.changeDescription}),t.riskAssessment.warnings.length>0&&e.jsx("div",{className:"space-y-1",children:t.riskAssessment.warnings.map((x,b)=>e.jsxs("div",{className:"text-sm flex items-center space-x-2",children:[e.jsx(M,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:x})]},b))})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(_e,{className:"w-5 h-5 text-blue-600"}),e.jsx("h4",{className:"font-medium text-blue-900",children:e.jsx(l,{id:"impactPreview.affectedPatients"})})]}),e.jsx("div",{className:"text-2xl font-bold text-blue-900 mb-1",children:t.affectedPatients.total}),e.jsx("div",{className:"text-sm text-blue-700",children:e.jsx(l,{id:"impactPreview.patients"})})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Re,{className:"w-5 h-5 text-green-600"}),e.jsx("h4",{className:"font-medium text-green-900",children:e.jsx(l,{id:"impactPreview.immediateActions"})})]}),e.jsx("div",{className:"text-2xl font-bold text-green-900 mb-1",children:t.workloadImpact.immediateActions}),e.jsx("div",{className:"text-sm text-green-700",children:e.jsx(l,{id:"impactPreview.actionsToday"})})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(xe,{className:"w-5 h-5 text-yellow-600"}),e.jsx("h4",{className:"font-medium text-yellow-900",children:e.jsx(l,{id:"impactPreview.workloadHours"})})]}),e.jsx("div",{className:"text-2xl font-bold text-yellow-900 mb-1",children:t.workloadImpact.estimatedHours}),e.jsx("div",{className:"text-sm text-yellow-700",children:e.jsx(l,{id:"impactPreview.hoursPerWeek"})})]}),e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(nt,{className:"w-5 h-5 text-purple-600"}),e.jsx("h4",{className:"font-medium text-purple-900",children:e.jsx(l,{id:"impactPreview.dueDateChanges"})})]}),e.jsx("div",{className:"text-2xl font-bold text-purple-900 mb-1",children:t.dueDateChanges.accelerated+t.dueDateChanges.delayed}),e.jsx("div",{className:"text-sm text-purple-700",children:e.jsx(l,{id:"impactPreview.stepsAffected"})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-md font-medium text-gray-900",children:e.jsx(l,{id:"impactPreview.detailedAnalysis"})}),e.jsx(L,{variant:"outline",size:"sm",onClick:()=>f(!g),children:g?e.jsx(l,{id:"impactPreview.hideDetails"}):e.jsx(l,{id:"impactPreview.showDetails"})})]}),g&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:e.jsx(l,{id:"impactPreview.patientRiskDistribution"})}),e.jsx("div",{className:"space-y-2",children:Object.entries(t.affectedPatients.byRiskLevel).map(([x,b])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(C,{variant:x==="critical"?"critical":x==="high"?"warning":"default",children:e.jsx(l,{id:`riskLevel.${x}`})}),e.jsx("span",{className:"font-medium",children:b})]},x))})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:e.jsx(l,{id:"impactPreview.cohortSizeChanges"})}),e.jsx("div",{className:"space-y-2",children:t.cohortImpact.cohortSizeChanges.map((x,b)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-700",children:x.cohortName}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:x.currentSize}),e.jsx("span",{children:"→"}),e.jsx("span",{className:x.change>0?"text-green-600":x.change<0?"text-red-600":"text-gray-600",children:x.newSize}),e.jsxs("span",{className:`text-xs ${x.change>0?"text-green-600":x.change<0?"text-red-600":"text-gray-600"}`,children:["(",x.change>0?"+":"",x.change,")"]})]})]},b))})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:e.jsx(l,{id:"impactPreview.workloadDistribution"})}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:e.jsx(l,{id:"impactPreview.thisWeek"})}),e.jsx("span",{className:"font-medium",children:t.workloadImpact.weeklyActions})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:e.jsx(l,{id:"impactPreview.thisMonth"})}),e.jsx("span",{className:"font-medium",children:t.workloadImpact.monthlyActions})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:e.jsx(l,{id:"impactPreview.timelineChanges"})}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-600",children:e.jsx(l,{id:"impactPreview.acceleratedSteps"})}),e.jsx("span",{className:"font-medium",children:t.dueDateChanges.accelerated})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-orange-600",children:e.jsx(l,{id:"impactPreview.delayedSteps"})}),e.jsx("span",{className:"font-medium",children:t.dueDateChanges.delayed})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-600",children:e.jsx(l,{id:"impactPreview.newSteps"})}),e.jsx("span",{className:"font-medium",children:t.dueDateChanges.newSteps})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-red-600",children:e.jsx(l,{id:"impactPreview.removedSteps"})}),e.jsx("span",{className:"font-medium",children:t.dueDateChanges.removedSteps})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(l,{id:"impactPreview.justification"}),e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx("textarea",{value:n,onChange:x=>r(x.target.value),placeholder:"Please provide clinical or operational justification for these changes...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),t.riskAssessment.level==="high"||t.riskAssessment.level==="critical"&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(M,{className:"w-5 h-5 text-yellow-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-yellow-800 font-medium",children:e.jsx(l,{id:"impactPreview.highRiskWarning"})}),e.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:e.jsx(l,{id:"impactPreview.reviewRequired"})})]})]})})]})]}),e.jsx("div",{className:"sticky bottom-0 bg-white border-t border-gray-200 px-6 py-4 rounded-b-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:e.jsx(l,{id:"impactPreview.changeWillBeLogged",values:{user:i.name,timestamp:new Date().toLocaleString()}})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(L,{variant:"outline",onClick:a,children:e.jsx(l,{id:"common.cancel"})}),e.jsx(L,{variant:"primary",onClick:y,disabled:!n.trim()||c,children:c?e.jsx(l,{id:"impactPreview.applying"}):e.jsx(l,{id:"impactPreview.confirmAndApply"})})]})]})})]})})}Me.__docgenInfo={description:"",methods:[],displayName:"ImpactPreviewModal",props:{isOpen:{required:!0,tsType:{name:"boolean"},description:""},impactData:{required:!0,tsType:{name:"ImpactPreviewData"},description:""},originalItem:{required:!0,tsType:{name:"union",raw:"PathwayTemplate | LocalOverride | any",elements:[{name:"PathwayTemplate"},{name:"LocalOverride"},{name:"any"}]},description:""},proposedChanges:{required:!0,tsType:{name:"any"},description:""},onConfirm:{required:!0,tsType:{name:"signature",type:"function",raw:"(justification: string) => Promise<void>",signature:{arguments:[{type:{name:"string"},name:"justification"}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},onCancel:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};function Ie({originalTemplate:o,existingOverride:t,onClose:s,onSave:a}){const i=Xe(),{locale:n}=de(),{user:r}=ce(),c=He(r.role),[d,g]=S.useState(()=>t||jt(o,r.name,"")),[f,p]=S.useState((t==null?void 0:t.justification)||""),[w,y]=S.useState(!1),[x,b]=S.useState(null),[k,$]=S.useState(!1),[A,P]=S.useState(null),[v,I]=S.useState(null),[h,D]=S.useState(null),[O,H]=S.useState(null),[E,Ee]=S.useState([]),[Te,me]=S.useState(null),q=yt(o,d.overrides),te=wt(q);S.useEffect(()=>{g(m=>{var j;return{...m,riskLevel:q,pendingApproval:te&&!((j=m.approvedBy)!=null&&j.length)}})},[q,te]),S.useEffect(()=>{const m=Ct(o,d);I(m);const j=Pt.analyzeDeviations(o,d);Ee(j);let u=K.getWorkflowMetadata(d.id);u||(u=K.initializeWorkflow(d.id,r.id,r.name,"draft")),D(u);const N=K.getWorkflowCapabilities(u.currentState,r.role,r.id,u);H(N)},[d,o,r]);const F=c.canConfigureThresholds,se=c.canApproveMassActions,ie=(m,j,u)=>{g(N=>{const _=[...N.overrides.steps];return _[m]={..._[m],[j]:u},{...N,overrides:{...N.overrides,steps:_},lastModified:new Date().toISOString()}})},qe=m=>{g(j=>{const u=[...j.overrides.steps];return u[m]={},{...j,overrides:{...j.overrides,steps:u},lastModified:new Date().toISOString()}})},Ge=()=>{g(m=>({...m,overrides:{steps:o.steps.map(()=>({}))},lastModified:new Date().toISOString()})),p("")},ae=async m=>{if(!(v!=null&&v.canSaveDraft)&&m==="draft"){b({message:"Cannot save draft due to validation errors",type:"error"});return}if(!(v!=null&&v.canRequestReview)&&m==="review"){b({message:"Cannot request review due to validation errors",type:"error"});return}if(!(v!=null&&v.canPublish)&&m==="publish"){b({message:"Cannot publish due to validation errors",type:"error"});return}if(!f.trim()){b({message:i.formatMessage({id:"pathwayOverride.justificationRequired"}),type:"error"});return}me(m);const j={...d,justification:f.trim()};if(m==="draft")await he(f,"draft");else{const u=St(o,j);P(u),$(!0)}},he=async(m,j)=>{const u={...d,justification:f.trim()},N=j||Te||"draft";try{if(h){const R=K.transitionState(d.id,N==="publish"?"published":N,r.id,r.name,m);D(R)}z.saveOverride(u),Dt(r.id,r.name,o.name.en,m,A||{},o,u),le("pathway_override_created",{templateId:o.id,overrideId:u.id,riskLevel:u.riskLevel,workflowState:N}),N==="review"?ne.notifyReviewRequested(u,o,r.name):N==="publish"&&(ne.notifyPathwayPublished(u,o,h),E.length>0&&ne.notifyNHGDeviations(u,o,E.map(R=>({field:R.field,nhgValue:R.nhgValue,localValue:R.localValue,riskLevel:R.riskLevel})))),a(u);const _={draft:"pathwayOverride.savedDraft",review:"pathwayOverride.reviewRequested",publish:"pathwayOverride.published"};b({message:i.formatMessage({id:_[N]||"pathwayOverride.saved"}),type:"success"}),$(!1),me(null)}catch(_){console.error("Error saving override:",_),b({message:"Error saving override: "+_.message,type:"error"})}},ze=()=>{if(!se)return;const m={...d,approvedBy:[...d.approvedBy||[],r.name],pendingApproval:!1};g(m),z.saveOverride(m),le("pathway_override_approved",{overrideId:d.id,approvedBy:r.name}),b({message:i.formatMessage({id:"pathwayOverride.approved"}),type:"success"})},ue=m=>{const j=o.steps[m],u=d.overrides.steps[m];return{...j,...u}},J=()=>d.overrides.steps.some(m=>Object.keys(m).length>0)||d.overrides.thresholds&&Object.keys(d.overrides.thresholds).length>0,Be=()=>{const m={low:"bg-green-100 text-green-800",medium:"bg-yellow-100 text-yellow-800",high:"bg-red-100 text-red-800"};return e.jsxs(C,{className:m[q],children:[q==="high"&&e.jsx(M,{className:"w-3 h-3 mr-1"}),q==="medium"&&e.jsx(oe,{className:"w-3 h-3 mr-1"}),e.jsx(l,{id:`pathwayOverride.risk.${q}`})]})},Ve=()=>{if(!h)return null;const m={draft:"bg-gray-100 border-gray-300 text-gray-800",review:"bg-yellow-100 border-yellow-300 text-yellow-800",published:"bg-green-100 border-green-300 text-green-800",archived:"bg-red-100 border-red-300 text-red-800"};return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:e.jsx(l,{id:"pathwayOverride.workflowStatus"})}),e.jsx(C,{className:m[h.currentState],children:e.jsx(l,{id:`pathwayOverride.workflow.${h.currentState}`})})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["v",h.version," • ",h.modifiedBy]})]}),h.publishedAt&&e.jsx("div",{className:"mt-2 text-sm text-gray-600",children:e.jsx(l,{id:"pathwayOverride.publishedAt",values:{date:new Date(h.publishedAt).toLocaleDateString(n),publisher:h.publishedBy}})})]})},We=()=>{if(!v)return null;const m=v.errors.length>0,j=v.warnings.length>0;return!m&&!j?null:e.jsx("div",{className:`border rounded-lg p-4 mb-6 ${m?"bg-red-50 border-red-200":"bg-yellow-50 border-yellow-200"}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(M,{className:`w-5 h-5 mt-0.5 ${m?"text-red-600":"text-yellow-600"}`}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:`font-medium mb-2 ${m?"text-red-900":"text-yellow-900"}`,children:m?e.jsx(l,{id:"pathwayOverride.validationErrors"}):e.jsx(l,{id:"pathwayOverride.validationWarnings"})}),m&&e.jsx("div",{className:"space-y-2 mb-3",children:v.errors.map((u,N)=>e.jsxs("div",{className:"text-sm text-red-800",children:["• ",u.message[n],u.nhgReference&&e.jsxs("span",{className:"ml-2 text-xs text-red-600",children:["(",u.nhgReference,")"]})]},N))}),j&&e.jsx("div",{className:"space-y-2",children:v.warnings.map((u,N)=>e.jsxs("div",{className:"text-sm text-yellow-800",children:["• ",u.message[n],u.nhgReference&&e.jsxs("span",{className:"ml-2 text-xs text-yellow-600",children:["(",u.nhgReference,")"]})]},N))})]})]})})},Ue=()=>{if(!E.length)return null;const m=E.filter(u=>u.riskLevel==="critical"),j=E.filter(u=>u.riskLevel==="high");return e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(M,{className:"w-5 h-5 text-orange-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-orange-900 mb-2",children:e.jsx(l,{id:"pathwayOverride.nhgDeviations",values:{count:E.length}})}),m.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx(C,{className:"bg-red-100 text-red-800 mb-2",children:e.jsx(l,{id:"pathwayOverride.criticalDeviations",values:{count:m.length}})}),e.jsx("div",{className:"space-y-1",children:m.map((u,N)=>e.jsxs("div",{className:"text-sm text-red-800",children:["• ",e.jsxs("strong",{children:[u.field,":"]})," ",u.localValue,e.jsxs("span",{className:"text-red-600",children:[" (NHG: ",u.nhgValue,")"]})]},N))})]}),j.length>0&&m.length===0&&e.jsxs("div",{className:"space-y-1",children:[E.slice(0,3).map((u,N)=>e.jsxs("div",{className:"text-sm text-orange-800",children:["• ",e.jsxs("strong",{children:[u.field,":"]})," ",u.localValue,e.jsxs("span",{className:"text-orange-600",children:[" (NHG: ",u.nhgValue,")"]})]},N)),E.length>3&&e.jsx("div",{className:"text-sm text-orange-600",children:e.jsx(l,{id:"pathwayOverride.moreDeviations",values:{count:E.length-3}})})]})]})]})})},Fe=()=>{var m;return te?e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(M,{className:"w-5 h-5 text-amber-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-amber-900 mb-2",children:e.jsx(l,{id:"pathwayOverride.approvalRequired"})}),e.jsx("p",{className:"text-sm text-amber-800 mb-3",children:e.jsx(l,{id:"pathwayOverride.approvalReason"})}),d.pendingApproval?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(C,{variant:"warning",children:e.jsx(l,{id:"pathwayOverride.pendingApproval"})}),se&&e.jsxs(L,{size:"sm",onClick:ze,children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),e.jsx(l,{id:"pathwayOverride.approve"})]})]}):(m=d.approvedBy)!=null&&m.length?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(C,{variant:"success",children:[e.jsx(W,{className:"w-3 h-3 mr-1"}),e.jsx(l,{id:"pathwayOverride.approved"})]}),e.jsx("span",{className:"text-sm text-amber-800",children:e.jsx(l,{id:"pathwayOverride.approvedBy",values:{approver:d.approvedBy.join(", ")}})})]}):null]})]})}):null},Je=()=>w?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:e.jsx(l,{id:"pathwayOverride.diffView"})}),e.jsxs(L,{variant:"outline",onClick:()=>y(!1),children:[e.jsx(gt,{className:"w-4 h-4 mr-2"}),e.jsx(l,{id:"pathwayOverride.hideDiff"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx(C,{variant:"default",className:"mr-2",children:"NHG Default"}),e.jsx("h4",{className:"font-medium text-gray-900",children:o.name[n]})]}),e.jsx("div",{className:"space-y-3",children:o.steps.map(m=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"font-medium text-sm text-gray-900",children:m.name[n]}),e.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[e.jsx(l,{id:"pathwayOverride.delay"}),": ",m.delay===0?i.formatMessage({id:"pathwayOverride.immediate"}):i.formatMessage({id:"pathwayOverride.days"},{count:m.delay})]}),e.jsxs("div",{className:"text-xs text-gray-600",children:[m.enabled?"✓":"✗"," ",m.automated?i.formatMessage({id:"pathwayOverride.automated"}):i.formatMessage({id:"pathwayOverride.manual"})]})]},m.id))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx(C,{variant:"warning",className:"mr-2",children:e.jsx(l,{id:"pathwayOverride.localOverride"})}),e.jsx("h4",{className:"font-medium text-gray-900",children:d.name[n]})]}),e.jsx("div",{className:"space-y-3",children:o.steps.map((m,j)=>{const u=ue(j),N=Object.keys(d.overrides.steps[j]||{}).length>0;return e.jsxs("div",{className:`p-3 rounded-lg ${N?"bg-yellow-50 border border-yellow-200":"bg-gray-50"}`,children:[e.jsxs("div",{className:"font-medium text-sm text-gray-900",children:[u.name[n],N&&e.jsx("span",{className:"ml-2 text-yellow-600",children:"*"})]}),e.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[e.jsx(l,{id:"pathwayOverride.delay"}),": ",u.delay===0?i.formatMessage({id:"pathwayOverride.immediate"}):i.formatMessage({id:"pathwayOverride.days"},{count:u.delay}),m.delay!==u.delay&&e.jsxs("span",{className:"text-yellow-600",children:[" (was ",m.delay,")"]})]}),e.jsxs("div",{className:"text-xs text-gray-600",children:[u.enabled?"✓":"✗"," ",u.automated?i.formatMessage({id:"pathwayOverride.automated"}):i.formatMessage({id:"pathwayOverride.manual"}),(m.enabled!==u.enabled||m.automated!==u.automated)&&e.jsx("span",{className:"text-yellow-600",children:" (changed)"})]})]},m.id)})})]})]})]}):null,Ke=()=>e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:e.jsx(l,{id:"pathwayOverride.stepEditor"})}),e.jsx("div",{className:"space-y-6",children:o.steps.map((m,j)=>{const u=ue(j),N=Object.keys(d.overrides.steps[j]||{}).length>0,_=Pe(m.id);return e.jsxs("div",{className:`border rounded-lg p-4 ${N?"border-yellow-300 bg-yellow-50":"border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-primary-600 text-white rounded-full flex items-center justify-center text-sm font-medium",children:j+1}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:m.name[n]}),_&&e.jsxs(C,{variant:"critical",className:"text-xs mt-1",children:[e.jsx(oe,{className:"w-3 h-3 mr-1"}),e.jsx(l,{id:"pathwayOverride.criticalStep"})]})]})]}),N&&e.jsxs(L,{variant:"outline",size:"sm",onClick:()=>qe(j),children:[e.jsx(fe,{className:"w-3 h-3 mr-1"}),e.jsx(l,{id:"pathwayOverride.revert"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(ee,{field:`${m.id}_delay`,children:e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e.jsx(l,{id:"pathwayOverride.delay"})})}),e.jsx("input",{type:"number",min:"0",max:"365",value:u.delay,onChange:R=>ie(j,"delay",parseInt(R.target.value)||0),disabled:!F,className:`w-full px-3 py-2 border rounded-md text-sm ${m.delay!==u.delay?"border-yellow-300 bg-yellow-50":"border-gray-300"} ${F?"":"bg-gray-50 text-gray-500"}`}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[e.jsx(l,{id:"pathwayOverride.originalValue"}),": ",m.delay]})]}),e.jsxs("div",{children:[e.jsx(ee,{field:`${m.id}_enabled`,children:e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e.jsx(l,{id:"pathwayOverride.enabled"})})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:u.enabled,onChange:R=>ie(j,"enabled",R.target.checked),disabled:!F||_&&!se,className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("span",{className:"text-sm text-gray-700",children:u.enabled?e.jsx(l,{id:"pathwayOverride.stepEnabled"}):e.jsx(l,{id:"pathwayOverride.stepDisabled"})}),_&&!u.enabled&&e.jsx(M,{className:"w-4 h-4 text-red-500"})]}),m.enabled!==u.enabled&&e.jsxs("div",{className:"text-xs text-yellow-600 mt-1",children:[e.jsx(l,{id:"pathwayOverride.originalValue"}),": ",m.enabled?i.formatMessage({id:"pathwayOverride.enabled"}):i.formatMessage({id:"pathwayOverride.disabled"})]})]}),e.jsxs("div",{children:[e.jsx(ee,{field:`${m.id}_automated`,children:e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e.jsx(l,{id:"pathwayOverride.automated"})})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:u.automated,onChange:R=>ie(j,"automated",R.target.checked),disabled:!F,className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("span",{className:"text-sm text-gray-700",children:u.automated?e.jsx(l,{id:"pathwayOverride.automatic"}):e.jsx(l,{id:"pathwayOverride.manual"})})]}),m.automated!==u.automated&&e.jsxs("div",{className:"text-xs text-yellow-600 mt-1",children:[e.jsx(l,{id:"pathwayOverride.originalValue"}),": ",m.automated?i.formatMessage({id:"pathwayOverride.automatic"}):i.formatMessage({id:"pathwayOverride.manual"})]})]})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsxs("strong",{children:[e.jsx(l,{id:"pathwayOverride.trigger"}),":"]})," ",m.trigger[n]]}),e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[e.jsxs("strong",{children:[e.jsx(l,{id:"pathwayOverride.action"}),":"]})," ",m.action[n]]}),e.jsx("div",{className:"text-xs text-gray-500 mt-2",children:e.jsx(l,{id:"pathwayOverride.readOnlyFields"})})]})]},m.id)})})]}),Ze=()=>e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:e.jsx(l,{id:"pathwayOverride.justification"})}),e.jsx("textarea",{value:f,onChange:m=>p(m.target.value),placeholder:i.formatMessage({id:"pathwayOverride.justificationPlaceholder"}),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:e.jsx(l,{id:"pathwayOverride.justificationRequired"})})]});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(L,{variant:"outline",onClick:s,children:[e.jsx(ot,{className:"w-4 h-4 mr-2"}),e.jsx(l,{id:"pathwayOverride.back"})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:e.jsx(l,{id:"pathwayOverride.editTitle"})}),e.jsxs("p",{className:"text-sm text-gray-600",children:[o.name[n]," • v",o.version]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[Be(),e.jsxs(L,{variant:"outline",onClick:()=>y(!w),disabled:!J(),children:[e.jsx(ut,{className:"w-4 h-4 mr-2"}),w?e.jsx(l,{id:"pathwayOverride.hideDiff"}):e.jsx(l,{id:"pathwayOverride.showDiff"})]})]})]}),Ve(),We(),Ue(),Fe(),Je(),Ke(),Ze(),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(L,{variant:"outline",onClick:Ge,children:[e.jsx(fe,{className:"w-4 h-4 mr-2"}),e.jsx(l,{id:"pathwayOverride.revertAll"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[(O==null?void 0:O.canSaveDraft)&&e.jsxs(L,{variant:"outline",onClick:()=>ae("draft"),disabled:!J()||!f.trim(),children:[e.jsx(dt,{className:"w-4 h-4 mr-2"}),e.jsx(l,{id:"pathwayOverride.saveDraft"})]}),(O==null?void 0:O.canRequestReview)&&e.jsxs(L,{onClick:()=>ae("review"),disabled:!J()||!f.trim()||!(v!=null&&v.canRequestReview),className:"bg-yellow-600 hover:bg-yellow-700",children:[e.jsx(_e,{className:"w-4 h-4 mr-2"}),e.jsx(l,{id:"pathwayOverride.requestReview"})]}),(O==null?void 0:O.canPublish)&&e.jsxs(L,{onClick:()=>ae("publish"),disabled:!J()||!f.trim()||!(v!=null&&v.canPublish),className:"bg-green-600 hover:bg-green-700",children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),e.jsx(l,{id:"pathwayOverride.publish"})]})]})]}),x&&e.jsx(rt,{message:x.message,type:x.type,onClose:()=>b(null)}),k&&A&&e.jsx(Me,{isOpen:k,impactData:A,originalItem:o,proposedChanges:d,onConfirm:he,onCancel:()=>$(!1)})]})}Ie.__docgenInfo={description:"",methods:[],displayName:"PathwayOverrideEditor",props:{originalTemplate:{required:!0,tsType:{name:"PathwayTemplate"},description:""},existingOverride:{required:!1,tsType:{name:"union",raw:"LocalOverride | null",elements:[{name:"LocalOverride"},{name:"null"}]},description:""},onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onSave:{required:!0,tsType:{name:"signature",type:"function",raw:"(override: LocalOverride) => void",signature:{arguments:[{type:{name:"LocalOverride"},name:"override"}],return:{name:"void"}}},description:""}}};function U(o){const{locale:t}=de(),{user:s}=ce(),a=He(s.role),[i,n]=S.useState(null),[r,c]=S.useState("grid"),[d,g]=S.useState([]),[f,p]=S.useState(null),w=Nt;S.useEffect(()=>{g(z.getOverrides())},[]);const y=h=>{switch(h){case"high":return"text-red-600 bg-red-50";case"medium":return"text-yellow-600 bg-yellow-50";case"low":return"text-green-600 bg-green-50";default:return"text-gray-600 bg-gray-50"}},x=h=>{switch(h){case"T2DM":return"🩺";case"Hypertension":return"❤️";case"Respiratory":return"🫁";default:return"📋"}},b=h=>{n(h),c("detail")},k=()=>{n(null),p(null),c("grid")},$=h=>{n(h),p(null),c("edit")},A=h=>{const D=d.find(O=>O.originalTemplateId===h.id);n(h),p(D||null),c("edit")},P=h=>{g(D=>{const O=D.findIndex(H=>H.id===h.id);if(O>=0){const H=[...D];return H[O]=h,H}else return[...D,h]}),k()},v=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:e.jsx(l,{id:"pathwayLibrary.title"})}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.jsx(l,{id:"pathwayLibrary.subtitle"})})]}),e.jsxs(C,{variant:"default",className:"flex items-center",children:[e.jsx(ct,{className:"w-3 h-3 mr-1"}),w.length," ",e.jsx(l,{id:"pathwayLibrary.templates"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:w.map(h=>{const D=d.some(H=>H.originalTemplateId===h.id),O=d.find(H=>H.originalTemplateId===h.id);return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-2xl",children:x(h.condition)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:h.name[t]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[h.condition," • v",h.version]})]})]}),e.jsxs("div",{className:"flex flex-col items-end space-y-1",children:[h.isNHGDefault&&e.jsxs(C,{variant:"default",className:"text-xs",children:[e.jsx(ve,{className:"w-3 h-3 mr-1"}),"NHG Default"]}),D&&e.jsxs(C,{variant:"warning",className:"text-xs",children:[e.jsx(ye,{className:"w-3 h-3 mr-1"}),e.jsx(l,{id:"pathwayLibrary.localOverride"})]}),(O==null?void 0:O.pendingApproval)&&e.jsxs(C,{variant:"critical",className:"text-xs",children:[e.jsx(ge,{className:"w-3 h-3 mr-1"}),e.jsx(l,{id:"pathwayLibrary.pendingApproval"})]})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:h.description[t]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:h.summary.totalSteps}),e.jsx("div",{className:"text-xs text-gray-500",children:e.jsx(l,{id:"pathwayLibrary.steps"})})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:h.summary.avgDuration}),e.jsx("div",{className:"text-xs text-gray-500",children:e.jsx(l,{id:"pathwayLibrary.duration"})})]}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${y(h.summary.priority)}`,children:e.jsx(l,{id:`pathwayLibrary.priority.${h.summary.priority}`})})})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100",children:[e.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[e.jsx(Re,{className:"w-3 h-3 mr-1"}),e.jsx(l,{id:"pathwayLibrary.createdBy",values:{creator:h.createdBy}})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(L,{variant:"outline",size:"sm",onClick:()=>b(h),children:[e.jsx(pt,{className:"w-3 h-3 mr-1"}),e.jsx(l,{id:"pathwayLibrary.view"})]}),a.canConfigureThresholds&&e.jsx(e.Fragment,{children:D?e.jsxs(L,{variant:"outline",size:"sm",onClick:()=>A(h),children:[e.jsx(re,{className:"w-3 h-3 mr-1"}),e.jsx(l,{id:"pathwayLibrary.editOverride"})]}):e.jsxs(L,{variant:"outline",size:"sm",onClick:()=>$(h),children:[e.jsx(ye,{className:"w-3 h-3 mr-1"}),e.jsx(l,{id:"pathwayLibrary.createOverride"})]})})]})]})]},h.id)})})]}),I=()=>i?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(L,{variant:"outline",onClick:k,children:["← ",e.jsx(l,{id:"pathwayLibrary.backToLibrary"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[a.canConfigureThresholds&&!i.isNHGDefault&&e.jsxs(L,{variant:"outline",children:[e.jsx(re,{className:"w-4 h-4 mr-2"}),e.jsx(l,{id:"pathwayLibrary.edit"})]}),e.jsxs(L,{variant:"outline",children:[e.jsx(ht,{className:"w-4 h-4 mr-2"}),e.jsx(l,{id:"pathwayLibrary.duplicate"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-3xl",children:x(i.condition)}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:i.name[t]}),e.jsx("p",{className:"text-gray-600 mt-1",children:i.description[t]})]})]}),e.jsxs("div",{className:"flex flex-col items-end space-y-2",children:[i.isNHGDefault&&e.jsxs(C,{variant:"default",children:[e.jsx(ve,{className:"w-3 h-3 mr-1"}),"NHG Default v",i.version]}),i.isModified&&e.jsxs(C,{variant:"warning",children:[e.jsx(re,{className:"w-3 h-3 mr-1"}),e.jsx(l,{id:"pathwayLibrary.locallyModified"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-6 mb-6 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:i.summary.totalSteps}),e.jsx("div",{className:"text-sm text-gray-600",children:e.jsx(l,{id:"pathwayLibrary.totalSteps"})})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:i.summary.avgDuration}),e.jsx("div",{className:"text-sm text-gray-600",children:e.jsx(l,{id:"pathwayLibrary.avgDuration"})})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${y(i.summary.priority)}`,children:e.jsx(l,{id:`pathwayLibrary.priority.${i.summary.priority}`})}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:e.jsx(l,{id:"pathwayLibrary.priority.label"})})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:Object.keys(i.thresholds).length}),e.jsx("div",{className:"text-sm text-gray-600",children:e.jsx(l,{id:"pathwayLibrary.thresholds"})})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:e.jsx(l,{id:"pathwayLibrary.clinicalThresholds"})}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(i.thresholds).map(([h,D])=>e.jsxs("div",{className:"p-3 border border-gray-200 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 capitalize",children:h}),e.jsx("div",{className:"text-lg font-semibold text-gray-700",children:D})]},h))})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:e.jsx(l,{id:"pathwayLibrary.pathwaySteps"})}),e.jsx("div",{className:"space-y-4",children:i.steps.map((h,D)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-primary-600 text-white rounded-full flex items-center justify-center text-sm font-medium",children:D+1}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:h.name[t]}),e.jsx("p",{className:"text-sm text-gray-500",children:h.trigger[t]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[h.automated&&e.jsxs(C,{variant:"success",className:"text-xs",children:[e.jsx(mt,{className:"w-3 h-3 mr-1"}),e.jsx(l,{id:"pathwayLibrary.automated"})]}),e.jsxs(C,{variant:h.enabled?"success":"default",className:"text-xs",children:[h.enabled?e.jsx(W,{className:"w-3 h-3 mr-1"}):e.jsx(ge,{className:"w-3 h-3 mr-1"}),e.jsx(l,{id:h.enabled?"pathwayLibrary.active":"pathwayLibrary.inactive"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-500",children:[e.jsx(l,{id:"pathwayLibrary.action"}),":"]}),e.jsx("span",{className:"ml-2 text-gray-900",children:h.action[t]})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-500",children:[e.jsx(l,{id:"pathwayLibrary.delay"}),":"]}),e.jsx("span",{className:"ml-2 text-gray-900",children:h.delay===0?e.jsx(l,{id:"pathwayLibrary.immediate"}):h.delay===1?e.jsx(l,{id:"pathwayLibrary.nextDay"}):e.jsx(l,{id:"pathwayLibrary.days",values:{count:h.delay}})})]})]})]},h.id))})]})]}):null;return e.jsxs("div",{children:[r==="grid"&&v(),r==="detail"&&I(),r==="edit"&&i&&e.jsx(Ie,{originalTemplate:i,existingOverride:f,onClose:k,onSave:P})]})}U.__docgenInfo={description:"",methods:[],displayName:"PathwayTemplateLibrary",props:{onSelectTemplate:{required:!1,tsType:{name:"signature",type:"function",raw:"(template: PathwayTemplate) => void",signature:{arguments:[{type:{name:"PathwayTemplate"},name:"template"}],return:{name:"void"}}},description:""}}};const It={nl:st},rs={title:"Organisms/PathwayTemplateLibrary",component:U,parameters:{layout:"fullscreen"},tags:["autodocs"],decorators:[o=>e.jsx(et,{children:e.jsx(tt,{messages:It.nl,locale:"nl",defaultLocale:"nl",children:e.jsx(it,{children:e.jsx("div",{className:"bg-gray-50 min-h-screen p-6",children:e.jsx(o,{})})})})})]},Z={},Q={render:()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Pathway Configuration"}),e.jsx("p",{className:"text-gray-600",children:"Manage and customize clinical pathways for your practice. Select a pathway template to view details and create local overrides."})]}),e.jsx(U,{})]})},Y={render:()=>e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Demo Mode:"})," Use the search and filter options to find specific pathways. Click on any pathway to see detailed configuration options."]})}),e.jsx(U,{})]})},X={render:()=>e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsx(U,{})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Quick Guide"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-primary-600 mr-2",children:"1."}),"Search for pathways by name or condition"]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-primary-600 mr-2",children:"2."}),"Filter by condition type or status"]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-primary-600 mr-2",children:"3."}),"Click on a pathway to configure"]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-primary-600 mr-2",children:"4."}),"Create local overrides as needed"]})]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-1",children:"Role Permissions"}),e.jsx("p",{className:"text-sm text-blue-800",children:"Your current role determines which pathways you can modify. Switch roles in the top bar to see different permissions."})]})]})]})};var we,be,je;Z.parameters={...Z.parameters,docs:{...(we=Z.parameters)==null?void 0:we.docs,source:{originalSource:"{}",...(je=(be=Z.parameters)==null?void 0:be.docs)==null?void 0:je.source}}};var Ne,ke,Se;Q.parameters={...Q.parameters,docs:{...(Ne=Q.parameters)==null?void 0:Ne.docs,source:{originalSource:`{
  render: () => <div className="space-y-6">
      <div className="bg-white p-6 rounded-lg shadow-sm">
        <h1 className="text-2xl font-bold text-gray-900 mb-2">Pathway Configuration</h1>
        <p className="text-gray-600">
          Manage and customize clinical pathways for your practice. Select a pathway template 
          to view details and create local overrides.
        </p>
      </div>
      <PathwayTemplateLibrary />
    </div>
}`,...(Se=(ke=Q.parameters)==null?void 0:ke.docs)==null?void 0:Se.source}}};var Ae,Oe,De;Y.parameters={...Y.parameters,docs:{...(Ae=Y.parameters)==null?void 0:Ae.docs,source:{originalSource:`{
  render: () => <div className="space-y-6">
      <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
        <p className="text-sm text-yellow-800">
          <strong>Demo Mode:</strong> Use the search and filter options to find specific pathways. 
          Click on any pathway to see detailed configuration options.
        </p>
      </div>
      <PathwayTemplateLibrary />
    </div>
}`,...(De=(Oe=Y.parameters)==null?void 0:Oe.docs)==null?void 0:De.source}}};var Le,Ce,$e;X.parameters={...X.parameters,docs:{...(Le=X.parameters)==null?void 0:Le.docs,source:{originalSource:`{
  render: () => <div className="grid grid-cols-1 lg:grid-cols-4 gap-6">
      <div className="lg:col-span-3">
        <PathwayTemplateLibrary />
      </div>
      <div className="space-y-4">
        <div className="bg-white p-4 rounded-lg shadow-sm">
          <h3 className="font-semibold text-gray-900 mb-2">Quick Guide</h3>
          <ul className="space-y-2 text-sm text-gray-600">
            <li className="flex items-start">
              <span className="text-primary-600 mr-2">1.</span>
              Search for pathways by name or condition
            </li>
            <li className="flex items-start">
              <span className="text-primary-600 mr-2">2.</span>
              Filter by condition type or status
            </li>
            <li className="flex items-start">
              <span className="text-primary-600 mr-2">3.</span>
              Click on a pathway to configure
            </li>
            <li className="flex items-start">
              <span className="text-primary-600 mr-2">4.</span>
              Create local overrides as needed
            </li>
          </ul>
        </div>
        
        <div className="bg-blue-50 p-4 rounded-lg">
          <h4 className="font-medium text-blue-900 mb-1">Role Permissions</h4>
          <p className="text-sm text-blue-800">
            Your current role determines which pathways you can modify. 
            Switch roles in the top bar to see different permissions.
          </p>
        </div>
      </div>
    </div>
}`,...($e=(Ce=X.parameters)==null?void 0:Ce.docs)==null?void 0:$e.source}}};const ns=["Default","WithHeader","FilteredView","WithInstructions"];export{Z as Default,Y as FilteredView,Q as WithHeader,X as WithInstructions,ns as __namedExportsOrder,rs as default};
